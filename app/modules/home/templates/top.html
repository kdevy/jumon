{% extends 'home/default.html' %}

{% block content %}
<div class="flex h-screen">
    <!-- 左サイドバー -->
    <div class="w-1/3 border-r border-gray-700 flex flex-col">
        <!-- タブボタン-->
        <div class="flex border-b border-gray-700">
            <button data-tab-group="side" data-tab-button="prompt_list"
                class="px-4 py-2 hover:bg-gray-700 border-r border-gray-700"><i class="fa-solid fa-list"></i></button>
            <button data-tab-group="side" data-tab-button="favo_prompt_list"
                class="px-4 py-2 hover:bg-gray-700 border-r border-gray-700"><i class="fa-solid fa-star"></i></button>
            <input type="text" placeholder="検索" class="bg-[#2d2d2d] text-white px-3 py-2 w-full outline-none" />
        </div>

        <div data-tab-group="side" data-tab-contents class="flex-1 overflow-auto bg-[#252526]">
            <p>タブの内容</p>
        </div>

        <!-- フッター-->
        <div class="border-t border-gray-700 p-4 bg-[#1e1e1e]">
            <p class="text-sm text-gray-400">任意のテキストがここに表示されます</p>
        </div>
    </div>

    <!-- メインエリア -->
    <div class="flex-1 flex flex-col">
        <!-- タブボタン 5,6 -->
        <div class="flex border-b border-gray-700">
            <button class="px-4 py-2 hover:bg-gray-700 border-r border-gray-700">Prompt</button>
            <button class="px-4 py-2 hover:bg-gray-700 border-r border-gray-700">Search</button>
        </div>

        <!-- コンテンツエリア（5番と6番の内容） -->
        <div class="flex-1 overflow-auto p-4 bg-[#1e1e1e]">
            <p>ここにタブ5または6の内容が表示されます</p>
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script>
    function fetch_prompt_list() {
        return "リスト";
    }

    function fetch_favo_prompt_list() {
        return "お気に入りリスト";
    }

    document.addEventListener('DOMContentLoaded', function () {
        document.addEventListener("click", function (event) {
            const tabButton = event.target.closest("[data-tab-button]");

            if (tabButton) {
                const tabGroupName = tabButton.getAttribute('data-tab-group');
                const tabName = tabButton.getAttribute('data-tab-button');
                const tabContentsElm = document.querySelector(`[data-tab-group="${tabGroupName}"][data-tab-contents]`);
                const anotherTabButtons = document.querySelectorAll(`[data-tab-group="${tabGroupName}"][data-tab-button]:not([data-tab-button="${tabName}"])`);

                tabButton.classList.add("text-orange-300");
                tabContentsElm.innerHTML = window["fetch_" + tabName].apply(window);
                anotherTabButtons.forEach(function (btn) {
                    btn.classList.remove("text-orange-300");
                });
            }
        });
    });

    function fetchApi(url, form, callback = null, errorCallback = null) {
        const formData = new FormData(form);
        const xhr = new XMLHttpRequest();

        xhr.open("POST", url, true);
        xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");

        xhr.onreadystatechange = function () {
            if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
                const data = JSON.parse(xhr.responseText);

                if (data.errors) {
                    alert("error");
                    console.error("server error: ", data.errors);
                    if (errorCallback) {
                        errorCallback(data, xhr);
                    }
                } else if (callback) {
                    callback(data);
                }
            }
        };

        xhr.send(formData);
    }
</script>
{% endblock %}